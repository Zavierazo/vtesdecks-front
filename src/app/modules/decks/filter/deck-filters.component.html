<div class="mt-2">
  <div class="d-grid gap-2 mb-3">
    <button type="button" class="btn btn-danger" (click)="reset()">
      Clear Filters
    </button>
  </div>
  <form [formGroup]="filterForm">
    <div *isLogged="true" class="row g-1 mb-2 items-center">
      <div class="form-check form-switch form-check-inline">
        <input class="form-check-input" type="checkbox" role="switch" id="favoriteCheck" formControlName="favorite" />
        <label class="form-check-label" for="favoriteCheck">Bookmarked</label>
      </div>
    </div>
    <label for="clans" class="form-label text-primary fw-bold">Tags</label>
    <div class="mb-2">
      <ng-template #tagTemplate let-r="result" let-t="term">
        <ngb-highlight class="align-top ms-1" [result]="'#'+r" [term]="t"></ngb-highlight>
      </ng-template>
      <input #tagsInput #tagsTypeahead="ngbTypeahead" id="deckTags" type="text" class="form-control"
        placeholder="Add Tags..." [ngbTypeahead]="searchTag" [resultTemplate]="tagTemplate" [editable]="false"
        (selectItem)="onSelectTagItem($event, tagsInput)" (focus)="tagFocus$.next($any($event).target.value)"
        (click)="tagClick$.next($any($event).target.value)" />
      <div *ngIf="tags" class="d-flex flex-wrap justify-content-start gap-2 my-2">
        <span *ngFor="let tag of tags" class="badge rounded-pill text-bg-primary btn-badge"
          (click)="onDeselectTag(tag)">
          #{{tag}}
        </span>
      </div>
    </div>
    <label for="clans" class="form-label text-primary fw-bold">Clans</label>
    <div class="form-check form-switch d-inline-block ms-2">
      <input class="form-check-input" type="checkbox" role="switch" id="singleClanCheck" formControlName="singleClan" />
      <label class="form-check-label" for="singleClanCheck">Single Clan</label>
    </div>
    <div id="clans" class="user-select-none mb-2">
      <app-clan-filter [(clans)]="clans" (clansChange)="changeClanFilter()">
      </app-clan-filter>
    </div>
    <label for="disciplines" class="form-label text-primary fw-bold">Disciplines</label>
    <div class="form-check form-switch d-inline-block ms-2">
      <input class="form-check-input" type="checkbox" role="switch" id="singleDisciplineCheck"
        formControlName="singleDiscipline" />
      <label class="form-check-label" for="singleDisciplineCheck">Single Discipline</label>
    </div>
    <div id="disciplines" class="user-select-none mb-2">
      <app-discipline-filter [(disciplines)]="disciplines" [showSuperior]="false"
        (disciplinesChange)="changeDisciplineFilter()">
      </app-discipline-filter>
    </div>
    <app-card-filter #cardFilter></app-card-filter>
    <label class="form-label text-primary fw-bold">Composition</label>
    <div class="row g-1 mb-2">
      <div class="col-12">
        <label for="librarySize" class="form-label text-secondary fw-bold">Library</label>
        <ngx-slider id="librarySize" [options]="{ floor: 60, ceil: 90, step: 1 }" formControlName="librarySize">
        </ngx-slider>
      </div>
      <div class="col-12 mb-2">
        <label for="cryptSize" class="form-label text-secondary fw-bold">Crypt</label>
        <ngx-slider id="cryptSize" [options]="{ floor: 12, ceil: 40, step: 1 }" formControlName="cryptSize">
        </ngx-slider>
      </div>
      <div class="col-12 mb-2">
        <label for="group" class="form-label text-secondary fw-bold">Group</label>
        <ngx-slider id="group" [options]="{
              floor: 0,
              ceil: 7,
              step: 1,
              showTicks: true,
              showTicksValues: true,
              translate: translateGroupSlider
            }" formControlName="group">
        </ngx-slider>
      </div>
      <div class="col-12 mb-2">
        <label for="year" class="form-label text-secondary fw-bold">Year</label>
        <ngx-slider id="year" [options]="{ floor: 1998, ceil: getCurrentYear(), step: 1 }" formControlName="year">
        </ngx-slider>
      </div>
      <div class="col-12 mb-2">
        <label for="players" class="form-label text-secondary fw-bold">Players</label>
        <ngx-slider id="players" [options]="{ floor: 10, ceil: 200, step: 1 }" formControlName="players">
        </ngx-slider>
      </div>
    </div>
    <label class="form-label text-secondary fw-bold">Library Cards</label>
    <div class="row d-inline-block ms-1" ngbTooltip="Switch between Percentage (%) and Absolute (#) cards proportion">
      <div class="col">
        <div class="d-inline-block me-1">%</div>
        <div class="form-check form-switch d-inline-block">
          <input class="form-check-input" type="checkbox" role="switch" id="absoluteProportion"
            formControlName="absoluteProportion" />
          <label for="absoluteProportion" class="form-check-label">#</label>
        </div>
      </div>
    </div>
    <div class="form-check d-inline-block ms-3" ngbTooltip="Customize Card Proportions.">
      <input class="form-check-input" type="checkbox" role="switch" id="customProportionCheck"
        formControlName="customProportion" />
      <label class="form-check-label" for="customProportionCheck">Custom</label>
    </div>
    <div class="row g-2 mb-2">
      <div class="col-6">
        <app-card-proportion controlName="master" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('master')"
          (valueChanges)="onProportionChange('master',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="action" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('action')"
          (valueChanges)="onProportionChange('action',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="political" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('political')"
          (valueChanges)="onProportionChange('political',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="retainer" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('retainer')"
          (valueChanges)="onProportionChange('retainer',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="equipment" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('equipment')"
          (valueChanges)="onProportionChange('equipment',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="ally" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('ally')" (valueChanges)="onProportionChange('ally',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="modifier" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('modifier')"
          (valueChanges)="onProportionChange('modifier',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="combat" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('combat')"
          (valueChanges)="onProportionChange('combat',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="reaction" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('reaction')"
          (valueChanges)="onProportionChange('reaction',$event)"></app-card-proportion>
      </div>
      <div class="col-6">
        <app-card-proportion controlName="event" [absolute]="absoluteProportion" [custom]="customProportion"
          [value]="getProportionValue('event')"
          (valueChanges)="onProportionChange('event',$event)"></app-card-proportion>
      </div>
    </div>
    <label class="form-label text-primary fw-bold">Other Filters</label>
    <div class="form-floating mb-2">
      <input type="text" class="form-control" id="deckName" placeholder="Name" formControlName="name" />
      <label for="deckName" class="text-primary">Name</label>
    </div>
    <div class="form-floating mb-2">
      <input type="text" class="form-control" id="deckAuthor" placeholder="Name" formControlName="author" />
      <label for="deckAuthor" class="text-primary">Author</label>
    </div>
    <div class="form-floating">
      <input type="text" class="form-control" id="deckCardText" placeholder="Name" formControlName="cardText" />
      <label for="deckCardText" class="text-primary">Card Text</label>
    </div>
  </form>
</div>