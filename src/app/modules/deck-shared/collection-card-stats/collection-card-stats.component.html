<ng-container *transloco="let t; read: 'deck_shared'">
  @if ((collectionStats$() | async); as collectionStats) {
  @if (collectionStats.decks && collectionStats.decks.total > 0) {
  <div class="card border-0 shadow-sm mt-3">
    <div class="card-header bg-primary text-white py-2">
      <h6 class="mb-0 fw-bold">
        <i class="bi bi-collection me-2"></i>{{ t('my_decks') }}
      </h6>
    </div>
    <div class="card-body p-2">
      @for (deck of collectionStats.decks.decks; track deck; let last = $last) {
      <div class="d-flex align-items-center py-1 border-dark" [class.border-bottom]="!last">
        <a class="text-decoration-none flex-grow-1" [routerLink]="'/deck/'+deck.id" (click)="routerClick.emit(true)">
          @if( deck.filterCards?.[0]?.number; as number ){
          <span class="badge bg-primary me-2">{{ number }}x</span>
          }
          <span class="fw-medium">{{ deck.name }}</span>
        </a>
      </div>
      }
    </div>
  </div>
  }
  @if (collectionStats.collectionNumber > 0) {
  <div class="card border-0 shadow-sm mt-3">
    <div class="card-header bg-success text-white py-2">
      <h6 class="mb-0 fw-bold">
        <i class="bi bi-archive me-2"></i>{{ t('my_collection') }}
        <span class="badge bg-light text-dark ms-2">{{ collectionStats.collectionNumber }}</span>
      </h6>
    </div>
    <div class="card-body p-2">
      @for (card of collectionStats.collectionCards; track card; let last = $last) {
      <div class="d-flex align-items-center justify-content-between py-1 border-dark" [class.border-bottom]="!last">
        <div class="flex-grow-1">
          <span class="badge bg-primary me-2">{{ card.number }}x</span>
          <span class="fw-medium">{{ card.cardName }}</span>
        </div>
        <div class="d-flex gap-1">
          @if(card.set) {
          <span class="badge bg-secondary" #tooltip="ngbTooltip" [ngbTooltip]="setContent" tabindex="0"
            triggers="mouseenter:mouseleave" container="body" (click)="tooltip.open()" (keyup)="tooltip.open()">
            {{ card.set }}
            <ng-template #setContent>
              <app-set-tooltip [cardId]="card.cardId" [set]="card.set"></app-set-tooltip>
            </ng-template>
          </span>
          }
          @if(card.language) {
          <span class="badge bg-info">{{ card.language }}</span>
          }
        </div>
      </div>
      }
      <div class="text-center">
        <a class="btn btn-outline-success btn-sm" [routerLink]="'/collection'"
          [queryParams]="{ cardName: collectionStats.collectionCards[0].cardName }" (click)="routerClick.emit(true)">
          <i class="bi bi-eye me-1"></i>{{ t('view_collection') }}
        </a>
      </div>
    </div>
  </div>
  }
  }
</ng-container>